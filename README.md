Most of this is copied from Shell Ninja, with some adjustments and removals of features that i don't use.
